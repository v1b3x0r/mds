# Layer 7: Interface
> Boundaries - Render, IO, Context

## What & Why
Adapters between MDS core and external world.
Render to screen, save/load worlds, provide context to LLMs.

## Philosophy
"Adapter pattern for everything external"
- Render: DOM, Canvas, WebGL, Headless (pluggable)
- IO: Load materials, save worlds, LLM bridges
- Context: Auto-inject system info for AI prompts

## Structure
```
7-interface/
â”œâ”€â”€ render/
â”‚   â”œâ”€â”€ adapter.ts          # RendererAdapter interface
â”‚   â”œâ”€â”€ dom-adapter.ts      # HTML rendering
â”‚   â”œâ”€â”€ canvas-adapter.ts   # Canvas 2D rendering
â”‚   â”œâ”€â”€ webgl-adapter.ts    # WebGL rendering
â”‚   â””â”€â”€ headless-adapter.ts # No rendering (simulation only)
â”œâ”€â”€ io/
â”‚   â”œâ”€â”€ reader.ts           # Load materials from JSON/MDM
â”‚   â”œâ”€â”€ writer.ts           # WorldFile serialization
â”‚   â”œâ”€â”€ mdm-parser.ts       # Parse .mdm.json format
â”‚   â”œâ”€â”€ bridge-llm.ts       # LLM adapter interface
â”‚   â””â”€â”€ llmAdapter.ts       # OpenAI/Anthropic/OpenRouter
â””â”€â”€ context/
    â”œâ”€â”€ types.ts            # CreatorContext (user signature)
    â””â”€â”€ context-v1.ts       # Auto-context providers (OS, Chat)
```

## Dependencies
âœ… Can import: 0-foundation, 1-ontology, schema
âŒ Cannot import: 2-physics, 3-cognition, 4-communication, 5-network, 6-world
ğŸ”„ Used by: Applications, 6-world (for serialization)

## Key Patterns
**Render:** `world.setRenderer(new DOMRenderer(container))`
**Save:** `toWorldFile(world)` â†’ JSON
**Load:** `fromWorldFile(worldFile)` â†’ reconstructs World
**LLM:** `setLlmBridge(new OpenAIBridge(apiKey))`
**Context:** `setCreatorContext({ user: { name, personality }})`

## Anti-Patterns
âŒ Assume specific renderer (use adapter)
âŒ Hardcode LLM provider (use bridge pattern)
âŒ Skip serialization validation
âŒ Leak internal state in WorldFile

## Common Tasks
**Switch renderer:** `world.setRenderer(new CanvasRenderer(canvas))`
**Save world:** `const file = toWorldFile(world); saveWorldFile(file, 'world.json')`
**Load world:** `const world = fromWorldFile(loadWorldFile('world.json'))`
**Enable LLM:** `enableLLM({ provider: 'openrouter', apiKey, model })`

## Notes for AI
- Adapters are **pluggable** - easy to add new renderers
- WorldFile format is versioned (v5 current)
- mdm-parser handles .mdm.json declarative format
- Context providers auto-inject system info (OS, time, etc.)
- Bridge pattern keeps LLM providers swappable
